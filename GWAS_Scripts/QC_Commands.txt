#!/bin/bash

module load plink

Options in effect:
  --bfile /u/home/s/sriram/ukbiobank/data/geno/imp/hard_calls/all
  --exclude /u/home/s/sriram/ukbiobank/data/geno/imp/hard_calls/mhc_of_all.txt
  --geno 0.01
  --hwe 1e-7
  --keep /u/home/s/sriram/ukbiobank/data/geno/cal/filter4.fam  //(unrelated white British individuals)
  --maf 0.01
  --make-bed
  --out /u/home/s/sriram/ukbiobank/data/geno/imp/Qced/qced



plink -bfile ~/project-ukbiobank/data/geno/imp/hard_calls/all --hwe 1e-10 --keep /u/home/s/sriram/ukbiobank/data/geno/cal/filter4.fam --maf 0.001 --make-bed --out  

#
--maf 0.001 #filters MAF > 0.001

#
--hwe 1e-10

#
--proxy-info-threshold 0.8 #maybe used for INFO threshold


#use to grab beta column possibly
cat maleHeightData.tsv | cut -f8  > maleHeightBetaData.txt

#remove first line (beta header)
echo "$(tail -n +2 maleHeightBetaData.txt)" > maleHeightBetaData.txt

awk '{print $5}' assoc_hard_calls_height.qassoc > heightData.txt
echo "$(tail -n +2 heightData.txt)" > heightData.txt


wget https://broad-ukb-sumstats-us-east-1.s3.amazonaws.com/round2/additive-tsvs/50_irnt.gwas.imputed_v3.both_sexes.tsv.bgz -O 50_irnt.gwas.imputed_v3.both_sexes.tsv.bgz

IDEA:
take bgen files and combine into one larger file using 
$ qctool -g [...].bgen -g [....].bgen -ofiletype bgen combined.bgen

combine mfi files into one larger file

plink --bgen [one file].bgen 

plink 
--bgen mydata.bgen
--keep mfi.txt
--geno 0.05
--hwe 1e-10 
--assoc 
--pheno ~/project-ukbiobank/33127/ukb21970_plink/filter4_pheno_files/height.pheno 
--covar ~/project-ukbiobank/33127/ukb21970_plink/filter4_pheno_files/height.covar  
--covar-name sex,f.22009.0.1,f.22009.0.2,f.22009.0.3,f.22009.0.4,f.22009.0.5,f.22009.0.6,f.22009.0.7,f.22009.0.8,f.22009.0.9,f.22009.0.10


#  --bfile /u/project/sriram/ukbiobank/data/geno/imp/hard_calls/all
#  --exclude /u/project/sriram/ukbiobank/data/geno/imp/hard_calls/mhc_of_all.txt
#  --geno 0.01
#  --hwe 1e-7
#  --keep /u/project/sriram/ukbiobank/data/geno/cal/filter4.fam
#  --maf 0.001
#  --make-bed
#  --out /u/home/s/sriram/ukbiobank/data/geno/imp/Qced/maf_0.001/all